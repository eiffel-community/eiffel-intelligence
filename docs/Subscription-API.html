<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2018-12-11 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20181211" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Eiffel Intelligence &#x2013; Subscription API</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                                                                                    <a class="brand" href="./" >

                                
                                    Eiffel Intelligence
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Home">Home</a>
</li>
                  
                      <li>      <a href="Configuration.html"  title="Configuration">Configuration</a>
</li>
                  
                      <li>      <a href="Running-Eiffel-Intelligence.html"  title="Running Eiffel Intelligence">Running Eiffel Intelligence</a>
</li>
                  
                      <li class="dropdown-submenu">
                                      <a href="REST-API.html"  title="REST API">REST API</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="Query.html"  title="Query">Query</a>
</li>
                                  <li>      <a href="Running-rules-on-objects.html"  title="Running rules on objects">Running rules on objects</a>
</li>
                                  <li>      <a href="Authentication.html"  title="Authentication">Authentication</a>
</li>
                                  <li>      <a href="Subscription-API.html"  title="Subscriptions">Subscriptions</a>
</li>
                                  <li>      <a href="Download-Files.html"  title="Download files">Download files</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="Subscriptions.html"  title="Subscriptions">Subscriptions</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="REST-POST-notification.html"  title="REST POST notification">REST POST notification</a>
</li>
                                  <li>      <a href="Email-notification.html"  title="Email notification">Email notification</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="Rules.html"  title="Rules">Rules</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="MergeResolverRules.html"  title="Merge Resolver Rules">Merge Resolver Rules</a>
</li>
                                  <li>      <a href="History-rules.html"  title="History Rules">History Rules</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="Step-by-Step-Aggregation.html"  title="Step-by-step aggregation">Step-by-step aggregation</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="ArtifactCreatedEvent-aggregation.html"  title="EiffelArtifactCreatedEvent aggregation">EiffelArtifactCreatedEvent aggregation</a>
</li>
                                  <li>      <a href="EiffelTestCaseTriggeredEvent-Aggregation.html"  title="EiffelTestCaseTriggeredEvent aggregation">EiffelTestCaseTriggeredEvent aggregation</a>
</li>
                                  <li>      <a href="EiffelTestCaseStartedEvent-aggregation.html"  title="EiffelTestCaseStartedEvent aggregation">EiffelTestCaseStartedEvent aggregation</a>
</li>
                                  <li>      <a href="EiffelTestCaseFinishedEvent-aggregation.html"  title="EiffelTestCaseFinishedEvent aggregation">EiffelTestCaseFinishedEvent aggregation</a>
</li>
                                  <li>      <a href="EiffelArtifactPublishedEvent-Aggregation.html"  title="EiffelArtifactPublishedEvent aggregation">EiffelArtifactPublishedEvent aggregation</a>
</li>
                                  <li>      <a href="EiffelConfidenceLevelModifiedEvent-Aggregation.html"  title="EiffelConfidenceLevelModifiedEvent">EiffelConfidenceLevelModifiedEvent</a>
</li>
                                  <li>      <a href="Step-by-Step-Subscription-Notification.html"  title="Step-by-step subscription notification">Step-by-step subscription notification</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="Known-limitations.html"  title="Known limitations">Known limitations</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Eiffel Intelligence</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
                    <span class="divider">-</span>
      </li>
        <li class="active ">Subscription API</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2018-12-11</li>
              <li id="projectVersion" class="pull-right">
                    Version: 0.0.18
        </li>
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                
      <li>
  
                          <a href="Configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="Running-Eiffel-Intelligence.html" title="Running Eiffel Intelligence">
          <span class="none"></span>
        Running Eiffel Intelligence</a>
            </li>
                                                                                                                                                    
      <li>
  
                          <a href="REST-API.html" title="REST API">
          <span class="icon-chevron-down"></span>
        REST API</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="Query.html" title="Query">
          <span class="none"></span>
        Query</a>
            </li>
                    
      <li>
  
                          <a href="Running-rules-on-objects.html" title="Running rules on objects">
          <span class="none"></span>
        Running rules on objects</a>
            </li>
                    
      <li>
  
                          <a href="Authentication.html" title="Authentication">
          <span class="none"></span>
        Authentication</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Subscriptions</a>
          </li>
                    
      <li>
  
                          <a href="Download-Files.html" title="Download files">
          <span class="none"></span>
        Download files</a>
            </li>
              </ul>
        </li>
                                                                                    
      <li>
  
                          <a href="Subscriptions.html" title="Subscriptions">
          <span class="icon-chevron-right"></span>
        Subscriptions</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="Rules.html" title="Rules">
          <span class="icon-chevron-right"></span>
        Rules</a>
                  </li>
                                                                                                                                                                              
      <li>
  
                          <a href="Step-by-Step-Aggregation.html" title="Step-by-step aggregation">
          <span class="icon-chevron-right"></span>
        Step-by-step aggregation</a>
                  </li>
                
      <li>
  
                          <a href="Known-limitations.html" title="Known limitations">
          <span class="none"></span>
        Known limitations</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Subscription API</h1>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th>Method</th>
<th>Endpoint               </th>
<th>Authentication</th></tr>
</thead><tbody>

<tr class="b">
<td>POST  </td>
<td>/subscriptions         </td>
<td>yes           </td></tr>
<tr class="a">
<td>GET   </td>
<td>/subscriptions/&lt;name&gt;</td>
<td>no            </td></tr>
<tr class="b">
<td>PUT   </td>
<td>/subscriptions         </td>
<td>yes           </td></tr>
<tr class="a">
<td>DELETE</td>
<td>/subscriptions/&lt;name&gt;</td>
<td>yes           </td></tr>
<tr class="b">
<td>GET   </td>
<td>/subscriptions         </td>
<td>no            </td></tr>
</tbody>
</table>
<div class="section">
<h2><a name="Create_subscriptions"></a>Create subscriptions</h2>
<p>Takes the subscription rules, the name for subscription and the user name of the person registering this subscription and saves the subscription in subscription database. The subscription name needs to be unique. Multiple subscriptions may be sent through a json array.</p>

<div>
<div>
<pre class="source">POST /subscriptions
</pre></div></div>

<p>Curl command example</p>

<div>
<div>
<pre class="source">curl -X POST -H &quot;Content-type: application/json&quot; --data @&lt;path to file&gt; http://&lt;host&gt;:8090/subscriptions
</pre></div></div>

<p>Example subscriptions</p>

<div>
<div>
<pre class="source">[
  {
    &quot;subscriptionName&quot;: &quot;Subscription_Test&quot;,
    &quot;ldapUserName&quot;: &quot;ABC&quot;,
    &quot;created&quot;: &quot;2018-08-13&quot;,
    &quot;repeat&quot;: false,
    &quot;notificationMeta&quot;: &quot;http://127.0.0.1:3000/ei/test_subscription_rest&quot;,
    &quot;notificationType&quot;: &quot;REST_POST&quot;,
    &quot;restPostBodyMediaType&quot;: &quot;application/x-www-form-urlencoded&quot;,
    &quot;notificationMessageKeyValues&quot;: [
      {
        &quot;formkey&quot;: &quot;e&quot;,
        &quot;formvalue&quot;: &quot;{parameter: [{ name: 'jsonparams', value : to_string(@) }, { name: 'runpipeline', value : 'mybuildstep' }]}&quot;
      }
    ],
    &quot;requirements&quot;: [
      {
        &quot;type&quot;: &quot;ARTIFACT_1&quot;,
        &quot;conditions&quot;: [
          {
           // notice single quotes surrounds the value to be checked
           // this tells jmespath that this is a constant and not 
           // an object from the aggregated object
            &quot;jmespath&quot;: &quot;gav.groupId=='com.mycompany.myproduct'&quot;
          },
          {
            &quot;jmespath&quot;: &quot;testCaseExecutions[?testCase.conclusion == 'SUCCESSFUL' &amp;&amp; testCase.id=='TC5']&quot;
          }
        ]
      },
      {
        &quot;type&quot;: &quot;ARTIFACT_1&quot;,
        &quot;conditions&quot;: [
          {
            &quot;jmespath&quot;: &quot;gav.groupId=='com.mycompany.myproduct'&quot;
          },
          {
            &quot;jmespath&quot;: &quot;testCaseExecutions[?testCaseStartedEventId == '13af4a14-f951-4346-a1ba-624c79f10e98']&quot;
          }
        ]
      }
    ]
  }
]


// this subscription will trigger a REST POST CALL
// when an artifact for issue JIRA-1234
// has passed testcase TC5 successfully
{
    &quot;created&quot;: &quot;2017-07-26&quot;,
    &quot;notificationMeta&quot;: &quot;http://127.0.0.1:3000/ei/test_subscription_rest&quot;,
    &quot;notificationType&quot;: &quot;REST_POST&quot;,
    &quot;restPostBodyMediaType&quot;: &quot;application/json&quot;,
    &quot;notificationMessageKeyValues&quot;: [
      {
        &quot;formkey&quot;: &quot;&quot;,
        &quot;formvalue&quot;: &quot;@&quot;
      }
    ],
    &quot;repeat&quot;: false,
    &quot;requirements&quot;: [
      {
        &quot;description&quot; : &quot;A subscription that will notify when an artifact for given issue id, has passed a certain test successfully&quot;,
        &quot;conditions&quot;: [         
          {            
            &quot;jmespath&quot;: &quot;incomplete_path_contains(@, 'issues.id','JIRA-1234')&quot;
          },
          {
            &quot;jmespath&quot;: &quot;(length(testCaseExecutions[?(outcome.id == 'TC5' &amp;&amp; outcome.conclusion == 'SUCCESSFUL')]) &gt; `0`)&quot;
          }
        ],
        &quot;type&quot;: &quot;ARTIFACT_1&quot;
      }
    ],
    &quot;subscriptionName&quot;: &quot;artifactRequirementSubscription&quot;,
    &quot;ldapUserName&quot;: &quot;ABC&quot;
}
</pre></div></div>

<p>Example of a subscription array</p>

<div>
<div>
<pre class="source">[
  {
    ..Subscription 1..
  },
  {
    ..Subscription 2..
  }
]
</pre></div></div>
</div>
<div class="section">
<h2><a name="Get_subscriptions_for_the_given_names"></a>Get subscriptions for the given names</h2>
<p>Get a single specific subscription or get multiples subscriptions with a comma separated list to the same endpoint</p>

<div>
<div>
<pre class="source">GET /subscriptions/&lt;name&gt;
GET /subscriptions/&lt;name&gt;,&lt;name&gt;,&lt;name&gt;
</pre></div></div>

<p>Curl command example</p>

<div>
<div>
<pre class="source">curl -X GET -H &quot;Content-type: application/json&quot;  http://&lt;host&gt;:8090/subscriptions/&lt;name&gt;,&lt;name&gt;,&lt;name&gt;
</pre></div></div>
</div>
<div class="section">
<h2><a name="Update_subscriptions"></a>Update subscriptions</h2>
<p>Modify existing Subscriptions based on subscriptionName. Multiple subscriptions may be sent through a json array.</p>

<div>
<div>
<pre class="source">PUT /subscriptions
</pre></div></div>

<p>Curl command example</p>

<div>
<div>
<pre class="source">curl -X PUT -H &quot;Content-type: application/json&quot;  --data @&lt;path to json file&gt; http://&lt;host&gt;:8090/subscriptions
</pre></div></div>
</div>
<div class="section">
<h2><a name="Delete_subscriptions_for_the_given_names"></a>Delete subscriptions for the given names</h2>
<p>Delete a single specific subscription or delete multiples subscriptions with a comma separated list to the same endpoint</p>

<div>
<div>
<pre class="source">DELETE /subscriptions/&lt;name&gt;
DELETE /subscriptions/&lt;name&gt;,&lt;name&gt;,&lt;name&gt;
</pre></div></div>

<p>Curl command example</p>

<div>
<div>
<pre class="source">curl -X DELETE -H &quot;Content-type: application/json&quot;  http://&lt;host&gt;:8090/subscriptions/&lt;name&gt;
</pre></div></div>
</div>
<div class="section">
<h2><a name="Get_all_subscriptions"></a>Get all subscriptions</h2>
<p>Retrieves all the subscriptions</p>

<div>
<div>
<pre class="source">GET /subscriptions
</pre></div></div>

<p>Curl command example</p>

<div>
<div>
<pre class="source">curl -X GET -H &quot;Content-type: application/json&quot;  http://&lt;host&gt;:8090/subscriptions
</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          
                </div>

        
                </div>
    </footer>
        </body>
</html>
